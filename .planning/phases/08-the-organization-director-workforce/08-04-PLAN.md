---
phase: 08-the-organization-director-workforce
plan: 04
type: execute
wave: 4
depends_on: ["08-01"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Budget CFO exists in agents.list and has a workspace with SOUL.md"
    - "Business Researcher exists in agents.list and has a workspace with SOUL.md"
    - "Both Directors were created via add-director.sh (not bootstrap.sh)"
  artifacts:
    - path: "/data/.openclaw/openclaw.json"
      provides: "budget-cfo and business-researcher in agents.list"
    - path: "/data/openclaw-workspace/agents/budget-cfo/SOUL.md"
      provides: "Budget CFO identity"
    - path: "/data/openclaw-workspace/agents/business-researcher/SOUL.md"
      provides: "Business Researcher identity"
  key_links:
    - from: "scripts/add-director.sh"
      to: "openclaw.json agents.list"
      via: "jq patch adding Director entry"
      pattern: "agents.list"
---

<objective>
Onboard Budget CFO and Business Researcher Directors using add-director.sh. This is a HUMAN-GUIDED plan: the user talks to the main agent and asks it to create these Directors, or runs add-director.sh manually.

Purpose: Validates the dynamic Director creation mechanism. These are the first Directors created outside of bootstrap.sh, proving the org can grow without repo changes.

Output:
- Budget CFO registered in agents.list with appropriate model and tools
- Business Researcher registered in agents.list with appropriate model and tools
- Both have workspace directories with SOUL.md
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@ARCHITECTURE_PLAN.md
@ARCHITECTURE_REFINEMENT.md
</context>

<tasks>

<task type="checkpoint:human-action" gate="blocking">
  <action>Create Budget CFO and Business Researcher via add-director.sh</action>
  <instructions>
**Option A: Run add-director.sh manually from the server**

SSH to the server and exec into the container:
```bash
sshpass -p '@pack86N5891' ssh -o StrictHostKeyChecking=no -o PreferredAuthentications=password ameer@192.168.1.100
CONTAINER=$(sudo docker ps --format '{{.Names}}' | grep openclaw | head -1)
```

Create Budget CFO:
```bash
sudo docker exec "$CONTAINER" bash /app/scripts/add-director.sh \
  --id budget-cfo \
  --name "Budget CFO" \
  --model "openrouter/anthropic/claude-sonnet-4-6" \
  --tools-profile standard \
  --workspace /data/openclaw-workspace/agents/budget-cfo
```

Create Business Researcher:
```bash
sudo docker exec "$CONTAINER" bash /app/scripts/add-director.sh \
  --id business-researcher \
  --name "Business Researcher" \
  --model "openrouter/anthropic/claude-sonnet-4-6" \
  --tools-profile standard \
  --workspace /data/openclaw-workspace/agents/business-researcher
```

**Option B: Ask the main agent to do it**

Send a message to the main agent (via Matrix or web UI):
> "Onboard two new Directors: Budget CFO (id: budget-cfo) and Business Researcher (id: business-researcher). Use add-director.sh for each. Both should use openrouter/anthropic/claude-sonnet-4-6 with standard tools profile."

The main agent should use Bash to call add-director.sh for each Director.

**After creating both Directors, customize their SOUL.md files:**

Budget CFO SOUL.md should include:
- Identity: Financial oversight Director, consumes monarch.transaction feed and financial emails
- Session protocol (same as Supervisor: persistent sessions, check context first, write to memory after tasks)
- Session routing: `hook:budget-cfo` (event stream), `hook:budget-cfo:task-<id>` (isolated tasks)
- Memory files: memory/patterns/ for financial patterns
- Escalation: financial anomalies -> main agent

Business Researcher SOUL.md should include:
- Identity: Research and communications Director, consumes newsletter feed and calendar events
- Session protocol (same pattern)
- Session routing: `hook:business-researcher` (event stream), `hook:business-researcher:task-<id>` (isolated tasks)
- Memory files: memory/patterns/ for research patterns
- Escalation: urgent research findings -> main agent

You can edit these SOUL.md files directly on the server:
```bash
sudo docker exec -it "$CONTAINER" bash
vi /data/openclaw-workspace/agents/budget-cfo/SOUL.md
vi /data/openclaw-workspace/agents/business-researcher/SOUL.md
```

Or ask the main agent to update them.
  </instructions>
**After running add-director.sh, confirm the gateway reloaded:**

add-director.sh sends SIGHUP to reload the gateway. Verify the reload happened:
```bash
# Check gateway logs for reload confirmation
sudo docker logs --tail=20 "$CONTAINER" | grep -E "reload|SIGHUP|agent.*registered|automation-supervisor"

# Or simply verify the new agents respond to a ping (confirms they are live, not just in JSON)
HOOKS_TOKEN=$(sudo docker exec "$CONTAINER" jq -r '.hooks.token' /data/.openclaw/openclaw.json)
curl -s -o /dev/null -w "%{http_code}" "http://192.168.1.100:18789/hooks/agent" \
  -H "Authorization: Bearer $HOOKS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"agentId": "budget-cfo", "sessionKey": "hook:budget-cfo", "message": "ping", "wakeMode": "now"}'
# Expected: 200. If 404: gateway hasn't reloaded yet. Restart container: sudo docker restart "$CONTAINER"
```

  <resume-signal>Type "directors-created" when both Directors are in agents.list AND responding to hooks (200), or describe issues</resume-signal>
</task>

<task type="auto">
  <name>Task 2: Verify Directors are registered and test hook routing</name>
  <files></files>
  <action>
After the user confirms Directors are created:

1. Verify agents.list:
```bash
CONTAINER=$(sudo docker ps --format '{{.Names}}' | grep openclaw | head -1)
sudo docker exec "$CONTAINER" jq '.agents.list[].id' /data/.openclaw/openclaw.json
```
Expected output: "main", "automation-supervisor", "budget-cfo", "business-researcher"

2. Verify workspaces exist:
```bash
sudo docker exec "$CONTAINER" ls -la /data/openclaw-workspace/agents/budget-cfo/SOUL.md
sudo docker exec "$CONTAINER" ls -la /data/openclaw-workspace/agents/business-researcher/SOUL.md
```

3. Send test hook messages to each Director:
```bash
HOOKS_TOKEN=$(sudo docker exec "$CONTAINER" jq -r '.hooks.token' /data/.openclaw/openclaw.json)

# Test Budget CFO
curl -s "http://192.168.1.100:18789/hooks/agent" \
  -H "Authorization: Bearer $HOOKS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"agentId": "budget-cfo", "sessionKey": "hook:budget-cfo", "message": "Test message: confirm you are the Budget CFO Director.", "wakeMode": "now"}'

# Test Business Researcher
curl -s "http://192.168.1.100:18789/hooks/agent" \
  -H "Authorization: Bearer $HOOKS_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"agentId": "business-researcher", "sessionKey": "hook:business-researcher", "message": "Test message: confirm you are the Business Researcher Director.", "wakeMode": "now"}'
```

4. Check gateway logs to confirm Directors responded (no 404, no routing errors).
  </action>
  <verify>
    - agents.list contains budget-cfo and business-researcher
    - Both Directors have SOUL.md in their workspace
    - Hook messages return 200 (not 404)
    - Gateway logs show the Directors processing the test messages
  </verify>
  <done>
    Budget CFO and Business Researcher are registered in agents.list, have workspaces with SOUL.md, and respond to hook messages.
  </done>
</task>

</tasks>

<verification>
1. `jq '.agents.list[].id' /data/.openclaw/openclaw.json` shows all 4 agents (main + 3 Directors)
2. Both new Directors have SOUL.md files with appropriate identity
3. Hook POSTs to each Director return 200
4. No "workflow-worker" in agents.list (it's ephemeral via sessions_spawn)
</verification>

<success_criteria>
- Budget CFO and Business Researcher exist in agents.list
- Both were created via add-director.sh (not hardcoded in bootstrap.sh)
- Both respond to hook messages
- Their SOUL.md files describe their domain and include session/memory protocol
</success_criteria>

<output>
After completion, create `.planning/phases/08-the-organization-director-workforce/08-04-SUMMARY.md`
</output>
